# 자동 배포 설정 (Auto Deploy)

## ✅ 자동 배포 작동 방식

Railway는 GitHub 저장소와 연결하면 **자동으로 배포**됩니다!

### 작동 원리

1. **GitHub 저장소 연결**
   - Railway에서 GitHub 저장소를 연결하면 자동으로 Webhook이 설정됩니다
   - 저장소에 푸시가 발생하면 Railway가 자동으로 감지합니다

2. **자동 배포 트리거**
   - 지정된 브랜치에 푸시하면 자동으로 배포가 시작됩니다
   - 기본값: `main` 또는 `master` 브랜치
   - 커스텀 브랜치도 설정 가능

3. **빌드 및 배포**
   - `railway.json` 파일이 있으면 자동으로 빌드/시작 명령을 사용합니다
   - 없으면 Railway가 자동으로 감지하여 빌드합니다

## 🔧 브랜치 설정

### 기본 설정 (main/master)

Railway는 기본적으로 `main` 또는 `master` 브랜치의 푸시를 감지합니다.

### develop 브랜치 사용하기

`develop` 브랜치를 사용하려면:

1. Railway 대시보드에서 서비스 선택
2. "Settings" → "Source" 탭
3. "Branch" 설정에서 `develop` 선택
4. 저장

이제 `develop` 브랜치에 푸시하면 자동으로 배포됩니다!

## 📝 배포 프로세스

### 1. 코드 푸시

```bash
git add .
git commit -m "[Phase X] 작업 내용"
git push origin develop  # 또는 main
```

### 2. 자동 배포 시작

- Railway가 푸시를 감지
- 자동으로 빌드 시작
- 빌드 완료 후 자동으로 배포

### 3. 배포 확인

- Railway 대시보드에서 배포 상태 확인
- "Deployments" 탭에서 진행 상황 확인
- 로그에서 빌드/배포 과정 확인

## ⚙️ 배포 설정 확인

### railway.json 파일

각 서비스의 `railway.json` 파일이 있으면 자동으로 사용됩니다:

- **Backend**: `apps/api/railway.json`
- **Frontend**: `apps/web/railway.json`

이 파일들이 있으면 Railway가 자동으로:
- 빌드 명령 실행
- 시작 명령 실행
- 재시작 정책 적용

### 수동 설정

`railway.json`이 없어도 Railway 대시보드에서 수동으로 설정 가능합니다.

## 🚀 배포 워크플로우

### 일반적인 워크플로우

```
1. 로컬에서 코드 수정
   ↓
2. git commit & push
   ↓
3. Railway가 자동 감지
   ↓
4. 자동 빌드 시작
   ↓
5. 자동 배포 완료
   ↓
6. 서비스 재시작
```

### 배포 시간

- **빌드 시간**: 약 2-5분 (프로젝트 크기에 따라)
- **배포 시간**: 약 30초-1분
- **총 소요 시간**: 약 3-6분

## 🔍 배포 상태 확인

### Railway 대시보드

1. 서비스 선택
2. "Deployments" 탭 확인
3. 최신 배포 상태 확인:
   - 🟢 **Success**: 배포 성공
   - 🟡 **Building**: 빌드 중
   - 🔴 **Failed**: 배포 실패

### 로그 확인

1. 서비스의 "Logs" 탭
2. 실시간 로그 확인
3. 에러 발생 시 로그에서 확인

## ⚠️ 주의사항

### 환경 변수

- 환경 변수는 **자동으로 유지**됩니다
- 푸시해도 환경 변수는 변경되지 않습니다
- 새로운 환경 변수가 필요하면 수동으로 추가해야 합니다

### 데이터베이스 마이그레이션

- **첫 배포 시**: 수동으로 마이그레이션 실행 필요
- **이후**: 마이그레이션 파일이 추가되면 Deploy Script에 포함하거나 수동 실행

### 빌드 실패 시

- 로그에서 에러 확인
- 환경 변수 확인
- 의존성 문제 확인
- Railway가 자동으로 재시도하지 않음 (수동 재배포 필요)

## 🎯 자동 배포 체크리스트

배포 전 확인:

- [ ] 코드가 올바른 브랜치에 푸시됨
- [ ] 환경 변수가 모두 설정됨
- [ ] `railway.json` 파일이 올바르게 설정됨
- [ ] 빌드 명령이 올바름
- [ ] 시작 명령이 올바름

## 📚 관련 문서

- [빠른 배포 가이드](./QUICK_DEPLOY.md)
- [Railway 설정 가이드](./RAILWAY_SETUP.md)
- [배포 체크리스트](./DEPLOYMENT_CHECKLIST.md)

---

**요약**: Git에 푸시하면 Railway가 자동으로 감지하여 배포합니다! 🚀

